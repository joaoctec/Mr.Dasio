<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mr. Dasio Lanches — Pedido</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <header class="topbar">
    <nav class="nav">
      <div class="logo-container">
        <a href="index.html" aria-label="Ir para a Home">
          <img class="logo" src="Imagens/Mr.Dacio_logo_preto.png" alt="Logo Mr. Dasio Lanches"/>
        </a>
      </div>
      <div class="nav-links">
        <a href="index.html">Home</a>
        <a href="pagina2.html">Cardápio</a>
        <a href="pagina3.html">História</a>
        <a href="pagina4.html" class="ativo">Pedido</a>
        <a href="pagina5.html">Contato</a>
      </div>
    </nav>
  </header>

  <main>
    <section class="container">
      <h1>Seu Pedido</h1>
      <div class="lista-pedidos" id="lista-pedidos" aria-live="polite"></div>
      <h3 id="total"></h3>

      <h2>Sugestões para você</h2>
      <div id="sugestoes" class="menu-grid"></div>

      <br>
      <button class="btn" onclick="confirmarPedido()">Confirmar Pedido</button>
    </section>
  </main>

  <script>
    const lista = document.getElementById("lista-pedidos");
    const total = document.getElementById("total");
    const sugestoesDiv = document.getElementById("sugestoes");

    const sugestoes = {
      "Espetinho de Frango": ["Batata Frita", "Refrigerante 350ml"],
      "Espetinho de Carne": ["Cerveja 600ml", "Mandioca"],
      "Cerveja 600ml": ["Espetinho de Frango", "Espetinho de Carne"],
      "Refrigerante 350ml": ["Espetinho de Frango"]
    };

    function carregarPedido() {
      const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
      lista.innerHTML = "";

      if (carrinho.length === 0) {
        lista.innerHTML = "<p>Nenhum item adicionado. Vá ao <a href='pagina2.html'>Cardápio</a> e adicione algo!</p>";
        total.innerText = "";
        sugestoesDiv.innerHTML = "<p>Sem sugestões no momento.</p>";
        return;
      }

      let soma = 0;
      carrinho.forEach((item, index) => {
        const subtotal = item.preco * item.quantidade;
        soma += subtotal;

        const div = document.createElement("div");
        div.classList.add("item-carrinho");
        div.innerHTML = `
          <strong>${item.nome}</strong>
          <small>R$ ${item.preco.toFixed(2)} x 
            <input aria-label="Quantidade de ${item.nome}" type="number" min="1" value="${item.quantidade}" onchange="atualizarQuantidade(${index}, this.value)">
            = R$ ${subtotal.toFixed(2)}
          </small>
          <button aria-label="Remover ${item.nome}" class="remove" onclick="removerItem(${index})">✕</button>
        `;
        lista.appendChild(div);
      });

      total.innerText = `Total: R$ ${soma.toFixed(2)}`;
      mostrarSugestoes(carrinho);
    }

    function mostrarSugestoes(carrinho) {
      sugestoesDiv.innerHTML = "";
      const nomes = carrinho.map(i => i.nome);
      const recomendados = new Set();

      nomes.forEach(n => {
        if (sugestoes[n]) sugestoes[n].forEach(s => recomendados.add(s));
      });

      if (!recomendados.size) {
        sugestoesDiv.innerHTML = "<p>Sem sugestões no momento.</p>";
        return;
      }

      recomendados.forEach(nome => {
        const card = document.createElement("div");
        card.classList.add("card");
        card.innerHTML = `
          <div class="card-body">
            <h5>${nome}</h5>
            <p>Experimente também!</p>
            <button class="btn" onclick="adicionarAoPedido('${nome}', 10)">Adicionar</button>
          </div>
        `;
        sugestoesDiv.appendChild(card);
      });
    }

    function atualizarQuantidade(index, novaQtd) {
      const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
      carrinho[index].quantidade = Math.max(1, parseInt(novaQtd));
      localStorage.setItem("carrinho", JSON.stringify(carrinho));
      carregarPedido();
    }

    function removerItem(index) {
      const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
      carrinho.splice(index, 1);
      localStorage.setItem("carrinho", JSON.stringify(carrinho));
      carregarPedido();
    }

    function adicionarAoPedido(nome, preco) {
      const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
      const item = carrinho.find(i => i.nome === nome);
      if (item) item.quantidade++;
      else carrinho.push({ nome, preco, quantidade: 1 });
      localStorage.setItem("carrinho", JSON.stringify(carrinho));
      carregarPedido();
    }

    function confirmarPedido() {
      alert("Pedido confirmado! Obrigado pela preferência!");
      localStorage.removeItem("carrinho");
      carregarPedido();
    }

    window.onload = carregarPedido;
  </script>

  <footer>
    <p>&copy; 2025 Mr. Dasio Lanches. Todos os direitos reservados.</p>
    <p><strong>Integrantes:</strong> João César Davi Rodrigres Carlos Augustus — <strong>Instituição:</strong> UCB</p>
  </footer>
</body>
</html>
